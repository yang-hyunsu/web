# 스프링부트와 함께 답편형 게시판
1. 주요기능
	1) 로그인하여 session으로 등록/수정/삭제 권한에 따라 
		처리한다.
	2) 페이지단위를 설정하여 한페이지에 보일 데이터 리스트 건수를
		지정한다.
	3) 하단에 페이징 리스트로 효과적으로 대량의 게시물을 관리할 수 있다.
	4) 첨부파일을 첨부하여 자료관리를 한다. 권한에 따른 자료에 다운로
		드처리
	5) 계층적으로 답글을 처리하여, 게시물에 대한 커뮤니케이션 기능을
		할 수 있다.
2. 처리프로세스
	1) 초기화면에 로그인 페이지가 나오고, 로그인하여 게시물의 메인
		페이지에 session을 가지고 들어간다.
	2) 답글이 처리된 페이지리스트가 출력되고, 하단에 페이지 번호를
		클릭시, 해당 페이지의 글을 확인할 수 있다.
	3) 글쓰기를 클릭하여 글쓰기 페이지가 나오고, 해당 글의 내용을
		등록한다. 작성자는 로그인 session값을 기준으로 자동 등록
		된다. 
	4) 파일을 다중으로 선택하여 첨부를 할 수 있다.
	5) 글 등록을 하면 메인 페이지에 리스트가 처리된다.
	6) 등록된 리스트 글을 클릭시, 상세 내용을 확인할 수 있고,
		첨부된 파일을 클릭시, 다운로드 할 수 있다.(이 부분도 권한을
		설정하여 해당 group 권한이 있는 session만이 다운로드가
		가능하다-현재사용자,관리자,그룹,모두)
	7) 글을 수정 삭제는 현재 로그인한 사용자와 작성자가 동일할 때마
		가능하게 session을 비교하여 처리한다.
	8) 답글 달기를 통해서, 해당 글에 대한 답글 등록을 할 수 있다.
	9) 답글이 등록되면, 메인화면 리스트에서 계층적으로 답글이라는
		것을 확인할 수 있다.
	10) 로그아웃을 통해서 session이 만료가 되면, 다시 로그인 하여야
		게시물을 확인할 수 있다.			

3. 개발순서
	1) DB설계
		board
		boardfile
		member
		board_seq(시쿼스)
	2) sql작성
		기본 계층적 조회
		고유 시퀀스번호 가져오기
		각 고유번호에 따른 게시물과 첨부파일
		멤버의 로그인
		게시물 등록
		게시물 첨부파일 정보 등록
		게시물 조회수 수정
		게시물 수정
		게시물 첨부파일 정보 수정
		게시물 삭제
		게시물 첨부파일 정보삭제
	3) VO
		조회를 위한 BoardSch : 조회, 페이징로직 포함
		리스트/등록/수정 위한 Board
		첨부파일 정보 BoardFile
		회원정보 Member
	4) Dao/Mapper
	5) Service단 
		페이징 처리를 위한 알고리즘
		- 특정한 페이지번호를 클릭시, 나타날 데이터 리스트
		하단에 페이징 블럭단위 리스트 처리 알고리즘
		- <- 1 2 3 4 5 ->
		위 형태로 하단에 블럭단위로 화살표로 좌우로 페이지
		리스트 번호가 범위에 따라 출력되어야 한다.
		
		파일업로드처리
			- 물리적 파일업로드
			- DB 입력/수정처리
		
	6) controller단
		로그인
		조회리스트
		등록처리
		상세화면
		답글처리(답글을 위한 요청값변경 후, 등록처리)
		수정처리
		삭제처리	
		
		처리 후, msg 및 session, 모델처리
	7) view단 처리
		로그인
			아이디 패스워드 입력 로그인 처리
		조회리스트
			상단에 @@ 로그인중 표시/로그아웃기능버튼
			검색할 form : 제목/작성자, 검색(버튼), 등록화면(버튼)
			리스트할 데이터
				글번호 제목 작성자 등록일 조회수
			한번에 보일 데이터 건수(선택 select)	
			좌우 화살표가 있는 페이지 블럭 리스트
		등록화면
			제목
			작성자
			등록할 내용
			첨부파일	
		상세화면
			글번호
			상위글번호
			제목
			작성자
			조회수
			등록할 내용
			첨부파일
			
			답글,수정,삭제,메인화면 기능 버튼
			상단 alert()으로 기능처리 메시지 출력			
				
4. 난이도에 따른 개발 순서
	1) 초기 리스트 화면 처리(페이지처리X)
	2) 로그인/로그아웃 session 처리
	3) 등록 처리(첨부파일X)
	4) 상세 화면 처리(조회수카운트업)
	5) 수정 처리(첨부파일X)
	6) 삭제 처리
	
	7) 답글 처리
	8) 계층형 sql 적용된 리스트 화면 처리
	9) 등록 첨부파일 처리
	10) 수정 첨부파일 처리
	11) 페이징 처리 리스트 service단
	12) 페이징 처리 리스트 화면처리

#  초기 리스트 화면 처리(페이지처리X)
1. DB부분
   1) sql
   	   select *
   	   from board
   	   where subject like '%'||#{subject}||'%'
   	   and writer  like '%'||#{writer}||'%'
   2) vo(BoardSch, Board)
   		com.web.board.vo.Board
   3) dao/mapper  BoardDao.java  BoardMapper.xml
   	   public List<Board> boardList(Board);
   ------------------------------------------------	   
2. service BoardService.java
   1) 초기 검색 null 처리
3. controller BoardController.java
	1) /boardList
	2) 요청값 Board				 	
	3) 모델처리
		boardList
4. 화면단 리스트 처리

---------------------------
# 로그인/로그아웃 session 처리
1. DB
	1) sql
	SELECT *
	FROM MEMBER01
	WHERE id = 'himan'
	AND pass = '7777'	
	2) VO
	3) Dao/mapper
		public Member login(Member mem);
------------------------------------------
		
2. service
3. controller
	1) 초기화면 로딩/로그인 처리
		public String login(Member login, Model d)
	2) 로그인 성공시 session 처리
		front단에서 main화면 이동
	3) 

# 등록 처리(첨부파일X)
1. 리스트에서 등록화면 버튼 클릭시, 등록화면이동
2. 등록 controller 초기 화면 호출.
	boardInsert
	a03_boardInsert.jsp	
	session 없을 때는 로그인 처리 하게 처리..
3. DB
	1) sql
		SELECT board_seq.nextval FROM dual	
	
		INSERT INTO board VALUES(1,0,'첫번째글','내용',
		'himan',0, sysdate, sysdate);
		
		INSERT INTO board VALUES(#{no},#{refno},
		#{subject},#{content},
		#{writer},0, sysdate, sysdate)	
	2) vo
	3) dao/mapper
		SELECT board_seq.nextval FROM dual	
	
		public int getNo();
		INSERT INTO board VALUES(#{no},#{refno},
		#{subject},#{content},
		#{writer},0, sysdate, sysdate)	
		
		public int insertBoard(Board insert);
4. service
	public String insertBoard(Board ins){
		ins.setNo(dao.getNo())
		return ins.insertBoard(ins)>0?"등록성공":"등록실패";
	}
	---------------------------------
5. controller
	insertBoard
	public String insertBoard(Board ins, Model d){
		if(ins.getSubject()!=null){
			d.addAttribute("msg",service.insertBoard(ins));
		}
		return ""
	}
6. 화면단처리(jsp)
	var msg = "${msg}"
	if(msg!=""){
		alert(msg);
	}
	
# 상세 화면 조회 처리
1. 처리 프로세스
	1) 리스트 화면에서 특정한 row를 클릭시, 상세화면 이동
	2) 상세화면에서 글번호, 상위글번호, 제목, 작성자,
		조회수, 내용, 첨부파일 출력을 확인할 수 있고,
	3) 기능버튼으로 답글, 수정, 삭제, 메인페이지이동을 처리할 수 있다.
2. 개발 순서
	1) DB 처리
		상세조회 sql : 
			select * from board where no  = #{no}
		VO 확인
		dao/mapper 처리
			public Board getBoard(int no);
	2) service
	--------------------------------------------
	3) controller
		@GetMapping(/boardDetail
			@RequestParam("no") int no
			d.addAttribute("board",service.getBoard(no));
	4) view(a01_boardList.jsp)
		tr ondblclick="goDetail(${board.no)"
			주의) js 넘기는 데이터 유형에 따라서 문자열형이면
				반드시 ''사이로 처리하여야 한다.
				ex) "goDetail('${board.writer')"
		function goDetail(no)
			location.href="${path}/boardDetail?no="+no
	    ----------------------------------------------
	    	
	   view(a04_boardDetail.jsp)
		name="no"	value="${board.no}"
		name="refno" value="" ==> value="0"	
		숫자형 VO의 property는 아에 없든지 있으면
		반드시 숫자형으로 초기값을 선언하여야 한다.
		그렇지 않으면 controller 요청 처리가 아에 되지 않는다.
		404발생.
			void setRefno(int refno)  int refno = ""
		name="refno" value="${board.refno}"	
		글번호   답글번호
		제목
		작성자   조회수
		등록일   수정일
		내용
		첨부파일		
		name="subject" value="${board.subject}"
		name="writer" value="${board.writer}"
		name="readcnt" value="${board.readcnt}"
		name="content" value="${board.content}"
		//name="report" value="${board.report}"
		id="reBtn"
		id="uptBtn"
		id="delBtn"
		id="mainBtn"
		$("#uptBtn").click(function(){
			// 각 기능 버튼마다 요청 action이 다른 경우 
			// 처리할 내용..
			$("form").attr("action","${path}/updateBoard");
		})
	5) 조회수 카운트업
		sql
			update board
				set readcnt = readcnt + 1
			 where no = #{no}
		dao/mapper	 
			public void readCntUp();
		service
			public Board detailBoard()
				dao.readCntUp();
				 	 	
# 수정 처리(첨부파일X)
1. 프로세스
	1) 수정할 내용 변경 수정버튼 클릭 
	2) 권한 점검 - 로그인한 회원만 작성한 글 수정 가능
	3) 수정 처리 프로세스 수정성공 알람 뜨고, 수정 내용 확인
		메인화면 이동 처리 여부 확인
2. 개발순서
	1) js에서 session id 가져오기
		 ex) var sessId = "${mem.id}"
	2) 수정 버튼 클릭시, 위	sessId와 현재 작성자 비교하여
		같지 않으면 수정권한이 없다고 처리
	3) 데이터 베이스 처리
		sql
		update board
			set subject=#{subject},
			    content=#{content},
			    uptdte = sysdate
			where no = #{no}
		dao/mapper
			public int updateBoard(Board upt);
	4) service
			public String updateBoard(Board upt){
				dao.updateBoard(upt)>0?"수정성공":"수정되지 않았습니다"
			}
		
	5) controller
		updateBoard
		public String updateBoard(Board upt,Model d){
			d.addAttribute("msg", service.updateBoard(upt));
			d.addAttribute("board",service.getBoard(upt.getNo()));
			
			return "a04_boardDetail"
		}  
		-------------------------------------	
	6) view(a04_boardDetail.jsp)
		$("#uptBtn").click(function(){
			if(confirm("수정하시겠습니까?")){
				$("form").attr("action","${path}/boardUpdate");
				$("form").submit();
			}
		})
		var msg = "${msg}"
		if(msg!=""){
			alert(msg)
			if(msg=="수정성공"){
				if(confirm("메인화면이동하시겠습니까?")){
					location.href="${path}/a01_boardList"
				}
			}
		}
		var sessId = "${mem.id}"
		if(sessId!=$("#writer").val()){
			$("#uptBtn").hide()
			$("#delBtn").hide()
		}
# 삭제 처리
1. 개발 순서
	1) sql
		delete from board where no = #{no}
	2) mapper/dao
		public int deleteBoard(int no);
		delete from board where no = #{no}
	3) service
		public String deleteBoard(int no){
			return dao.deleteBoard(no)>0?"삭제성공":"삭제되지 않음";
		}
	4) controller
		deleteBoard
		public String deleteBoard(@RequestParam("no") String no)
	5) jsp
		$("#delBtn").click(function(){
			if(confirm("삭제하시겠습니까?")){
				location.href=
				"${path}/deleteBoard?no="+$("#no").val();
			}
		})			
# 답글 처리
1. 프로세스
	1) 상세화면에서 답글을 클릭
	2) 등록화면이동되면서 
		제목에 기존글에 RE:@@@ 가 붙는다.
		내용도 기존글 내용을 포함해서 
			=== 상위글 ====
		입력하게 처리한다.
	3) 등록처리하면, 등록프로세스가 처리되어 조회화면에
		계층적으로 처리가 된다.
2. 개발순서
	1) 상세화면에서 답글 클릭시
		no의 값이 refno에 할당되게 처리한다.
		subject의 값은 "RE:"가 붙어서 처리된다.
		content는 내용은 \n\n\n\n\n\n=====이전글=====\n+이전글내용
		을 포함하여 js로 처리한다.
	2) 요청값으로 글등록에 전송이 된다.
		$("form").submit() 처리
	3) 글등록 화면에 답글을 위한 데이터가 처리된 상황에서
		글을 등록한다.
	4) 등록 처리시, 답글이 위 규칙에 의해 DB에 등록 된다.
		
	5) 등록과 답글처리에 대한 로직 처리
		- 글등록 초기화면(DB처리X)
			refno가 0
			subject가 없음
		- 답글달기 초기화면(DB처리X)
			refno가 0이 아님
			subject가 RE 있음
		- 글내용 등록시 조건(DB 처리)
			일반글 등록
			refno가 0
			subject가 있음
			
			답글 등록
			refno가 0>0
			subject가 있음
			
		
			
		
		
		
					
		 
		
		

		
				

			
	


			 		
		
		
	


